<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Guardi√µes do Rio Tocantins ‚Äî Jogo Multijogador</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body{font-family:'Press Start 2P',cursive;background:#021a1a;color:#2fbf71}
    .splash{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#000;z-index:999}
    .splash-container{position:relative;display:inline-block}
    .splash-img{max-width:600px;display:block;border:4px solid #2fbf71}
    #startGame{
      position:absolute; top:42%; left:50%; transform:translateX(-50%);
      width:300px; height:85px;
      background:transparent; border:none; color:transparent;
      cursor:pointer; outline:none;
    }
    .wrap{max-width:1000px;margin:20px auto;padding:20px;background:#000;border:4px solid #2fbf71}
    .topbar{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .cats{display:flex;gap:8px;flex-wrap:wrap}
    .cat{border:2px solid #2fbf71;background:#021a1a;color:#2fbf71;padding:8px 10px;cursor:pointer}
    .cat.active{background:#2fbf71;color:#000}
    .players{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .player-card{padding:8px;border:2px solid #2fbf71;display:inline-flex;gap:8px;align-items:center}
    .player-card.active{background:#2fbf71;color:#000}
    .question{margin:20px 0;padding:10px;border:2px solid #2fbf71;min-height:64px}
    .choices{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .choice{padding:10px;border:2px solid #2fbf71;cursor:pointer;background:#021a1a;color:#2fbf71}
    .choice.correct{border-color:#27ae60;color:#27ae60}
    .choice.wrong{border-color:#e74c3c;color:#e74c3c}
    .hint{margin-top:10px;font-size:10px;min-height:28px}
    .controls{display:flex;gap:10px;margin-top:12px}
    .panel{display:grid;grid-template-columns:2fr 1fr;gap:16px;margin-top:16px}
    .events{border:2px solid #2fbf71;padding:10px;max-height:180px;overflow:auto}
    .events h4{margin:0 0 8px 0;font-size:12px}
    .event-item{font-size:10px;margin:2px 0}
    .config{display:flex;gap:8px;align-items:center}
    .config label{font-size:10px}
    .config select,.config input{background:#021a1a;color:#2fbf71;border:2px solid #2fbf71;padding:6px}
    .muted{opacity:.8;font-size:10px}
    .btn{background:#2fbf71;color:#000;padding:10px 18px;border:none;cursor:pointer}
  </style>
</head>
<body>
  <!-- Tela de capa -->
<div id="splash" class="splash">
  <div class="splash-container">
    <img src="assets/capa_jogo.png" alt="Capa do Jogo" class="splash-img">
    <button id="startGame" aria-label="Jogar"></button>
    <!-- Bot√£o de som -->
    <button id="toggleSound" style="
      position:absolute; bottom:20px; right:20px;
      background:#2fbf71; color:#000; border:none;
      padding:8px 12px; cursor:pointer; font-size:20px;">
      üîä
    </button>
  </div>
</div>

<!-- Som da capa -->
<audio id="somCapa" src="som-capa.mp3" preload="auto" loop></audio>

  <!-- Conte√∫do do jogo -->
  <div class="wrap" style="display:none" id="gameWrap">
    <div class="topbar">
      <div class="cats">
        <button class="cat active" data-cat="facil">F√°cil</button>
        <button class="cat" data-cat="medio">M√©dio</button>
        <button class="cat" data-cat="dificil">Dif√≠cil</button>
      </div>
      <div class="config">
        <label for="playerCount">Jogadores:</label>
        <select id="playerCount">
          <option value="1">1</option>
          <option value="2" selected>2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
        <label for="playerNames">Nomes (separados por v√≠rgula):</label>
        <input id="playerNames" type="text" placeholder="Jogador 1, Jogador 2">
        <button id="applyPlayers" class="btn">Aplicar</button>
      </div>
      <div class="muted" id="turn">Vez: Jogador 1</div>
    </div>

    <div id="question" class="question">Carregando pergunta...</div>
    <div id="choices" class="choices"></div>
    <div id="hint" class="hint">A explica√ß√£o aparecer√° aqui ap√≥s responder.</div>

    <div class="controls">
      <button id="next" class="btn" disabled>Pr√≥xima</button>
      <button id="restart" class="btn">Reiniciar</button>
      <button id="showAnswers" class="btn">Ver respostas</button>
    </div>

    <div class="panel">
      <div class="events">
        <h4>Eventos</h4>
        <div id="eventsList"></div>
      </div>
      <div>
        <div class="players" id="players"></div>
      </div>
    </div>
  </div>

  <!-- Sons -->
  <audio id="somCerto" src="som-certo.mp3" preload="auto"></audio>
  <audio id="somErrado" src="som-errado.mp3" preload="auto"></audio>
  <!-- Som da capa (opcional) -->
  <audio id="somStart" src="som-start.mp3" preload="auto"></audio>

<script>
  // ====================== CONFIGURA√á√ïES ======================
  let soundEnabled = true;

  // Sons b√°sicos (ajustado para algo que realmente existe)
  const somCerto = document.getElementById('somCerto');
  const somErrado = document.getElementById('somErrado');
  const somStart = document.getElementById('somStart');

  // Banco de perguntas
  const DB = {
    facil: [
      {q:"Qual √© o pH considerado neutro em √°gua pura?",opts:["pH 0","pH 7","pH 14","pH 3"],a:1,exp:"pH 7 √© a refer√™ncia para neutralidade da √°gua pura √† temperatura padr√£o."},
      {q:"Qual g√°s proveniente de mat√©ria org√¢nica em decomposi√ß√£o pode causar mau cheiro em rios?",opts:["Oxig√™nio","Nitrog√™nio","Metano","H√©lio"],a:2,exp:"Metano √© produzido por decomposi√ß√£o anaer√≥bia e tem odor caracter√≠stico quando misturado com outros gases."},
      {q:"O que significa Esgoto tratado antes de lan√ßado no rio?",opts:["Sem tratamento","Tratamento para reduzir poluentes","Adi√ß√£o de produtos qu√≠micos perigosos","Aquecimento do esgoto"],a:1,exp:"Esgoto tratado passou por processos para reduzir mat√©ria org√¢nica, s√≥lidos e microrganismos antes do lan√ßamento."},
      {q:"Qual √© a principal fonte de nutrientes que causa eutrofiza√ß√£o?",opts:["Pl√°stico","Fertilizantes","Areia","Vidro"],a:1,exp:"Fertilizantes ricos em nitrog√™nio e f√≥sforo aumentam a produ√ß√£o de algas, levando √† eutrofiza√ß√£o."},
      {q:"Qual metal pesado √© conhecido por ser t√≥xico em pequenas quantidades?",opts:["Ferro","Cobre","Chumbo","C√°lcio"],a:2,exp:"Chumbo √© altamente t√≥xico e pode causar danos neurol√≥gicos mesmo em baixas concentra√ß√µes."},
      {q:"Qual processo remove bact√©rias e v√≠rus da √°gua?",opts:["Filtra√ß√£o","Clora√ß√£o","Sedimenta√ß√£o","Decanta√ß√£o"],a:1,exp:"A clora√ß√£o √© amplamente usada para desinfetar √°gua e eliminar muitos microrganismos patog√™nicos."},
      {q:"Qual √© a f√≥rmula qu√≠mica da √°gua?",opts:["O2","H2O","CO2","NaCl"],a:1,exp:"H2O representa duas mol√©culas de hidrog√™nio ligadas a uma de oxig√™nio."},
      {q:"Qual destes √© um indicador de baixa qualidade de √°gua?",opts:["Alta biodiversidade","Baixo oxig√™nio dissolvido","√Ågua cristalina","Presen√ßa de peixes nativos"],a:1,exp:"Baixo oxig√™nio dissolvido geralmente indica polui√ß√£o e afeta organismos aqu√°ticos."},
      {q:"O que √© biodegrad√°vel?",opts:["Algo que n√£o se quebra","Algo que pode ser degradado por microrganismos","Algo t√≥xico","Algo que brilha"],a:1,exp:"Material biodegrad√°vel pode ser degradado por bact√©rias, fungos e outros organismos."},
      {q:"Qual atividade humana contribui diretamente para assoreamento?",opts:["Pesca sustent√°vel","Desmatamento","Reciclagem","Plantio de √°rvores"],a:1,exp:"Desmatamento aumenta eros√£o do solo, que se deposita nos cursos d'√°gua causando assoreamento."},
      {q:"Que elemento √© essencial para a vida e encontrado em prote√≠nas?",opts:["Nitrog√™nio","Ne√¥nio","Chumbo","Ouro"],a:0,exp:"O nitrog√™nio faz parte de amino√°cidos e bases nitrogenadas, essenciais em prote√≠nas e DNA."},
      {q:"Qual √© a cor t√≠pica da √°gua contaminada por certos metais?",opts:["Verde cristalina","Transparente sempre","Marrom/avermelhada","Roxa"],a:2,exp:"Oxida√ß√µes de ferro e outros metais podem tingir a √°gua de tons avermelhados ou marrons."},
      {q:"O que significa pH abaixo de 7?",opts:["√Åcido","Neutro","B√°sico","Inst√°vel"],a:0,exp:"pH menor que 7 caracteriza solu√ß√µes √°cidas."},
      {q:"Qual pr√°tica reduz a polui√ß√£o agr√≠cola no rio?",opts:["Uso excessivo de fertilizantes","Cultura de prote√ß√£o de margem (rip√°ria)","Desmatamento ribeirinho","Queima de res√≠duos"],a:1,exp:"Faixas rip√°rias filtram sedimentos e poluentes antes que alcancem o rio."},
      {q:"Qual instrumento mede o pH da √°gua?",opts:["Higr√¥metro","pHmetro","Term√¥metro","Bar√¥metro"],a:1,exp:"pHmetro (ou papel indicador) mede acidez/alkalinidade da √°gua."}
    ],
    medio: [
      {q:"O que √© demanda bioqu√≠mica de oxig√™nio (DBO)?",opts:["Quantidade de oxig√™nio consumida por microrganismos para decompor mat√©ria org√¢nica","Quantidade de oxig√™nio em bolhas","Quantidade de oxig√™nio gerada pela fotoss√≠ntese","Quantidade de oxig√™nio em metais"],a:0,exp:"DBO alta indica muita mat√©ria org√¢nica que consome oxig√™nio quando decomposta."},
      {q:"Qual composto √© indicador de contamina√ß√£o por esgoto dom√©stico?",opts:["Nitrato/Am√¥nia","Silicato","Arg√¥nio","Oz√¥nio"],a:0,exp:"Am√¥nia e nitratos geralmente aumentam em √°guas afetadas por esgoto e fertilizantes."},
      {q:"O que causa a forma√ß√£o de zonas mortas em ambientes aqu√°ticos?",opts:["Aumento do oxig√™nio","Eutrofiza√ß√£o levando a an√≥xia","Menos nutrientes","Aumento da biodiversidade"],a:1,exp:"Quando algas morrem, sua decomposi√ß√£o consome oxig√™nio, criando zonas com pouco ou nenhum O2."},
      {q:"Qual tratamento √© prim√°rio em esta√ß√µes de tratamento de esgoto?",opts:["Clora√ß√£o","Tratamento biol√≥gico","Gradeamento e decanta√ß√£o","Oxida√ß√£o avan√ßada"],a:2,exp:"Gradeamento e decanta√ß√£o removem s√≥lidos grosseiros e sedimentos como etapa prim√°ria."},
      {q:"O que s√£o micropl√°sticos?",opts:["Pequenas part√≠culas pl√°sticas menores que 5 mm","Bact√©rias marinhas","Part√≠culas de areia","Algas microsc√≥picas"],a:0,exp:"Micropl√°sticos resultam da quebra de pl√°sticos maiores ou s√£o fabricados pequenos (microesferas)."},
      {q:"Qual processo qu√≠mico converte am√¥nia em nitrito e nitrato?",opts:["Nitrifica√ß√£o","Denitrifica√ß√£o","Sulfata√ß√£o","Flocula√ß√£o"],a:0,exp:"Nitrifica√ß√£o √© realizada por bact√©rias aer√≥bias que transformam NH3 em NO2- e NO3-."},
      {q:"Qual metal pode causar problemas neurol√≥gicos cr√¥nicos?",opts:["Cobre","Merc√∫rio","Ferro","Zinco"],a:1,exp:"Merc√∫rio √© neurot√≥xico e pode causar danos severos ao sistema nervoso."},
      {q:"Como o pH influencia a toxicidade de metais em √°gua?",opts:["pH baixo pode aumentar solubilidade e toxicidade","pH n√£o tem efeito","pH alto sempre neutraliza metais","Metais n√£o dissolvem em √°gua"],a:0,exp:"Em pH √°cido muitos metais tornam-se mais sol√∫veis, aumentando a exposi√ß√£o biol√≥gica."},
      {q:"O que s√£o bacias hidrogr√°ficas?",opts:["√Åreas que drenam √°gua para um mesmo ponto","Lagos artificiais","Tanto faz","Regi√£o costeira apenas"],a:0,exp:"Uma bacia coleta √°gua superficial que converge para um rio, lago ou oceano."},
      {q:"Qual m√©todo remove sais dissolvidos da √°gua?",opts:["Filtra√ß√£o simples","Dessaliniza√ß√£o por osmose reversa","Clora√ß√£o","Decanta√ß√£o"],a:1,exp:"Osmose reversa √© usada para dessalinizar √°gua removendo sais por membranas semiperme√°veis."},
      {q:"O que √© lixivia√ß√£o?",opts:["Movimenta√ß√£o de subst√¢ncias pelo solo at√© a √°gua subterr√¢nea","Forma√ß√£o de gelo","Evapora√ß√£o r√°pida","Queima controlada"],a:0,exp:"Lixivia√ß√£o transporta fertilizantes e contaminantes para len√ß√≥is fre√°ticos."},
      {q:"Qual composto √© usado para desinfetar √°gua pot√°vel?",opts:["Cloro","Metano","√ìleo","C√°dmio"],a:0,exp:"O cloro √© eficaz contra muitos microrganismos e √© amplamente usado em redes de abastecimento."},
      {q:"O que √© bioacumula√ß√£o?",opts:["Ac√∫mulo de subst√¢ncias qu√≠micas em organismos ao longo do tempo","Processo de lavagem de roupas","Separa√ß√£o por decanta√ß√£o","Quebra r√°pida de poluentes"],a:0,exp:"Subst√¢ncias como metais podem concentrar-se nos tecidos de um organismo com o tempo."},
      {q:"Como a cobertura vegetal protege rios?",opts:["Aumenta assoreamento","Reduz eros√£o e filtra poluentes","Aumenta temperatura","N√£o tem efeito"],a:1,exp:"Ra√≠zes estabilizam o solo e a vegeta√ß√£o atua como filtro de sedimentos e nutrientes."},
      {q:"Qual √© a consequ√™ncia da alta turbidez?",opts:["Mais luz penetrando na √°gua","Menos fotoss√≠ntese e estresse para organismos","Aumento do oxig√™nio","Melhor qualidade da √°gua"],a:1,exp:"Part√≠culas em suspens√£o bloqueiam luz, reduzindo fotoss√≠ntese e afetando ecossistemas aqu√°ticos."}
    ],
    dificil: [
      {q:"O que √© fen√¥meno de \"limite de solubilidade\" em √°gua?",opts:["Quantidade m√°xima de soluto que se dissolve em uma quantidade fixa de solvente a uma temperatura dada","Quantidade m√≠nima que pode se dissolver","Quantidade que sempre evapora","N√£o existe limite"],a:0,exp:"A solubilidade depende de temperatura e press√£o; al√©m do limite, o soluto precipita."},
      {q:"Qual √© o efeito do aumento de temperatura na solubilidade do oxig√™nio em √°gua?",opts:["Aumenta solubilidade","Diminui solubilidade","N√£o muda","Oxig√™nio se transforma em outro g√°s"],a:1,exp:"Oxig√™nio dissolvido diminui com o aumento da temperatura, reduzindo disponibilidade para organismos."},
      {q:"O que s√£o \"POPs\" (poluentes org√¢nicos persistentes)?",opts:["Poluentes que se degradam rapidamente","Subst√¢ncias org√¢nicas que persistem no ambiente e bioacumulam","Novo tipo de fertilizante","Microalgas"],a:1,exp:"POPs como DDT persistem e se acumulam na cadeia alimentar, sendo muito perigosos."},
      {q:"Qual t√©cnica anal√≠tica √© usada para identificar metais tra√ßo?",opts:["Espectrometria de absor√ß√£o at√¥mica (AAS)","pHmetro","Term√¥metro","Refratometria"],a:0,exp:"AAS √© sens√≠vel para detectar concentra√ß√µes muito baixas de metais em amostras."},
      {q:"O que √© \"zona f√≥tica\" em um corpo d'√°gua?",opts:["Camada onde h√° luz suficiente para fotoss√≠ntese","Camada sem luz","Regi√£o subterr√¢nea","√Årea de sedimentos"],a:0,exp:"A zona f√≥tica recebe luz e permite crescimento de plantas aqu√°ticas e algas fotossint√©ticas."},
      {q:"Qual processo reduz nitratos em ambientes an√≥xicos?",opts:["Nitrifica√ß√£o","Denitrifica√ß√£o","Calagem","Flocula√ß√£o"],a:1,exp:"Denitrifica√ß√£o converte nitrato em nitrog√™nio gasoso em condi√ß√µes pouco oxigenadas."},
      {q:"O que √© \"capacidade tamp√£o\" de uma √°gua?",opts:["Facilidade com que o pH muda quando √°cidos ou bases s√£o adicionados","Velocidade de corrente","Quantidade de oxig√™nio","Temperatura da √°gua"],a:0,exp:"Tamp√£o indica resist√™ncia do pH a varia√ß√µes; √°guas com alto bicarbonato t√™m maior capacidade tamp√£o."},
      {q:"Qual composto derivado de petr√≥leo √© t√≥xico e tende a acumular-se em sedimentos?",opts:["Hidrocarbonetos polic√≠clicos arom√°ticos (HPAs)","Sal marinho","Cloreto de s√≥dio","Etanol"],a:0,exp:"HPAs s√£o persistentes e se ligam a part√≠culas e sedimentos, afetando organismos bent√¥nicos."},
      {q:"O que √© \"biomagnifica√ß√£o\"?",opts:["Aumento da concentra√ß√£o de subst√¢ncias t√≥xicas ao longo da cadeia alimentar","Diminui√ß√£o de poluentes na cadeia alimentar","Separa√ß√£o de sedimentos","Filtra√ß√£o natural"],a:0,exp:"Predadores topo de cadeia acumulam maiores concentra√ß√µes de toxinas presentes em presas."},
      {q:"Qual √≠on √© comumente medido para avaliar salinidade?",opts:["Na+ (s√≥dio)","Ca2+","Mg2+","K+"],a:0,exp:"O s√≥dio √© um dos principais √≠ons que comp√µem a salinidade da √°gua."},
      {q:"O que √© oxida√ß√£o avan√ßada no tratamento de √°gua?",opts:["Uso de processos que geram radicais livres para degradar contaminantes","Fermenta√ß√£o","Decanta√ß√£o simples","Filtra√ß√£o por areia"],a:0,exp:"Processos como ozoniza√ß√£o e UV/H2O2 geram radicais que oxidam contaminantes persistentes."},
      {q:"Qual par√¢metro indica processo de deoxigena√ß√£o por decomposi√ß√£o microbiana?",opts:["Baixa DBO","Alta DBO","pH 7","Baixa turbidez"],a:1,exp:"Alta DBO significa maior consumo de oxig√™nio pela decomposi√ß√£o, levando √† desoxigena√ß√£o."},
      {q:"Como se chama a transforma√ß√£o de sulfato em sulfeto por bact√©rias?",opts:["Sulfata√ß√£o","Sulfita√ß√£o","Redu√ß√£o de sulfato (dessor√ß√£o bacteriana)","Redu√ß√£o de sulfato (sulfateredu√ß√£o)"],a:3,exp:"Sulfateredu√ß√£o √© realizada por bact√©rias anaer√≥bias que reduzem SO4(2-) a S2-."},
      {q:"Por que o monitoramento de metais tra√ßo √© importante?",opts:["Eles s√£o sempre inofensivos","Podem ser t√≥xicos em concentra√ß√µes baixas e persistir no ambiente","N√£o se ligam a organismos","Eles evaporam rapidamente"],a:1,exp:"Metais tra√ßo podem acumular e causar efeitos cr√¥nicos em organismos e ecossistemas."},
      {q:"Qual processo natural pode remover poluentes atrav√©s de plantas e solo?",opts:["Fitorremedia√ß√£o","IncineracÃßaÃÉo","Dessaliniza√ß√£o","Clora√ß√£o"],a:0,exp:"Fitorremedia√ß√£o usa plantas para absorver ou degradar contaminantes no solo e √°gua."}
    ]
  };

  // Estado do jogo (apenas UMA vez, corrigido)
  let state = {
    cat: "facil",
    qIndex: 0,
    players: [{name:"Jogador 1",score:0},{name:"Jogador 2",score:0}],
    currentPlayer: 0,
    roundQuestions: [],
    paused: false,
    showCorrectAlways: false
  };

  const el = {
    question: document.getElementById("question"),
    choices: document.getElementById("choices"),
    hint: document.getElementById("hint"),
    nextBtn: document.getElementById("next"),
    playersWrap: document.getElementById("players"),
    turn: document.getElementById("turn"),
    eventsList: document.getElementById("eventsList"),
    playerCount: document.getElementById("playerCount"),
    playerNames: document.getElementById("playerNames"),
    applyPlayers: document.getElementById("applyPlayers"),
    showAnswers: document.getElementById("showAnswers")
  };

  // Log de eventos
  function logEvent(text){
    const div = document.createElement("div");
    div.className = "event-item";
    const ts = new Date().toLocaleTimeString();
    div.textContent = `[${ts}] ${text}`;
    el.eventsList.prepend(div);
  }

  // Mostrar jogo ap√≥s clicar em "JOGAR"
  document.getElementById("startGame").addEventListener("click",()=>{
    // toca som se existir e som estiver habilitado
    if (soundEnabled && somStart) somStart.play();
    document.getElementById("splash").style.display="none";
    document.getElementById("gameWrap").style.display="block";
    startCategory("facil");
  });

  // Aplicar jogadores (quantidade e nomes)
  el.applyPlayers.addEventListener("click",()=>{
    const count = Number(el.playerCount.value);
    const namesRaw = el.playerNames.value.trim();
    let names = [];
    if(namesRaw.length){
      names = namesRaw.split(",").map(s=>s.trim()).filter(Boolean).slice(0,count);
    }
    state.players = Array.from({length:count},(_,i)=>({
      name: names[i] || `Jogador ${i+1}`,
      score: 0
    }));
    state.currentPlayer = 0;
    renderPlayers();
    updateTurn();
    logEvent(`Jogadores definidos: ${state.players.map(p=>p.name).join(", ")}`);
  });

  // Troca de categoria
  document.querySelectorAll(".cat").forEach(btn=>{
    btn.addEventListener("click",()=>{
      document.querySelectorAll(".cat").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      startCategory(btn.dataset.cat);
    });
  });

  function startCategory(cat){
    state.cat = cat;
    state.roundQuestions = DB[cat] || [];
    state.qIndex = 0;
    state.currentPlayer = 0;
    state.paused = false;
    renderPlayers();
    renderQuestion();
    updateTurn();
    logEvent(`Categoria iniciada: ${cat} (${state.roundQuestions.length} perguntas)`);
  }

  function renderPlayers(){
    el.playersWrap.innerHTML = "";
    state.players.forEach((p,i)=>{
      const div = document.createElement("div");
      div.className = "player-card" + (i===state.currentPlayer ? " active" : "");
      div.textContent = `${p.name}: ${p.score} pts`;
      el.playersWrap.appendChild(div);
    });
  }

  function updateTurn(){
    el.turn.textContent = `Vez: ${state.players[state.currentPlayer]?.name || "‚Äî"}`;
  }

  function renderQuestion(){
    const q = state.roundQuestions[state.qIndex];
    if(!q){
      el.question.textContent = "Sem perguntas nesta categoria.";
      el.choices.innerHTML = "";
      el.hint.textContent = "";
      el.nextBtn.disabled = true;
      return;
    }
    el.question.textContent = q.q;
    el.choices.innerHTML = "";
    q.opts.forEach((opt,i)=>{
      const btn = document.createElement("button");
      btn.className = "choice";
      btn.textContent = opt;
      btn.dataset.index = i;
      btn.addEventListener("click",()=>selectChoice(btn,q));
      el.choices.appendChild(btn);
    });
    el.hint.textContent = "A explica√ß√£o aparecer√° aqui ap√≥s responder.";
    el.nextBtn.disabled = true;
    state.paused = false;
    logEvent(`Pergunta ${state.qIndex+1}/${state.roundQuestions.length}: exibida`);
  }

  function selectChoice(btn,q){
    if(state.paused) return;
    state.paused = true;

    Array.from(el.choices.children).forEach(b=>b.disabled=true);
    const chosen = Number(btn.dataset.index);
    const currentP = state.players[state.currentPlayer];

    if(chosen === q.a){
      btn.classList.add("correct");
      currentP.score += 10;
      el.hint.textContent = `Correto! +10 pts. Explica√ß√£o: ${q.exp}`;
      if (soundEnabled && somCerto) somCerto.play();
      logEvent(`${currentP.name} acertou (+10 pts)`);
    } else {
      btn.classList.add("wrong");
      const correctBtn = Array.from(el.choices.children).find(b=>Number(b.dataset.index)===q.a);
      if(correctBtn) correctBtn.classList.add("correct");
      el.hint.textContent = `Errado. Explica√ß√£o: ${q.exp}`;
      if (soundEnabled && somErrado) somErrado.play();
      logEvent(`${currentP.name} errou`);
    }
    renderPlayers();
    el.nextBtn.disabled = false;
  }

  el.nextBtn.addEventListener("click",()=>{
    state.paused = false;
    state.currentPlayer = (state.currentPlayer + 1) % state.players.length;
    state.qIndex++;
    updateTurn();

    if(state.qIndex >= state.roundQuestions.length){
      el.question.textContent = "Fim da categoria!";
      el.choices.innerHTML = "";
      el.hint.textContent = "Parab√©ns, guardi√µes!";
      el.nextBtn.disabled = true;
      logEvent(`Categoria conclu√≠da. Placar final: ${state.players.map(p=>`${p.name} ${p.score}pts`).join(" | ")}`);
    } else {
      renderQuestion();
    }
  });

  document.getElementById("restart").addEventListener("click",()=>{
    state.players.forEach(p=>p.score=0);
    startCategory(state.cat);
    logEvent("Jogo reiniciado");
  });

  // Mostrar respostas (marca o correto sem pontuar)
  el.showAnswers.addEventListener("click",()=>{
    const q = state.roundQuestions[state.qIndex];
    if(!q) return;
    Array.from(el.choices.children).forEach(b=>b.classList.remove("correct","wrong"));
    const correctBtn = Array.from(el.choices.children).find(b=>Number(b.dataset.index)===q.a);
    if(correctBtn) correctBtn.classList.add("correct");
    logEvent("Resposta correta destacada");
  });
</script>
</body>
</html>